---
# Defaults file for artifactory

# The version of artifactory to install
artifactory_version: 7.84.14

# **Mandatory.** The hostname used to access the Artifactory server. Adjust for production environments.
artifactory_server_name: "{{ inventory_hostname if '.' in inventory_hostname else 'test.artifactory.com' }}"

# [NGINX] Install and configure NGINX with Artifactory (default: true). Set to false if NGINX is not required.
artifactory_nginx_installed: true

# Provide single or HA individual licenses file separated by new line and 2-space indentation and for HA, set artifactory_ha_enabled: true.
# Example: Replace <license_1> , <license_2> , <license_3> with original licenses
# artifactory_licenses: |-
#   <license_1>

#   <license_2>

#   <license_3>

# If this is an upgrade-only
artifactory_upgrade_only: false

# To enable HA, set to true
artifactory_ha_enabled: false

# By default, all nodes are primary (CNHA) - https://www.jfrog.com/confluence/display/JFROG/High+Availability#HighAvailability-Cloud-NativeHighAvailability
artifactory_taskaffinity: any

# To enable mission-control in artifactory (>= 7.27.x) applicable only on E+ license
artifactory_mc_enabled: true

# Artifactory installation directories
artifactory_jfrog_dir: "{{ jfrog_home_directory | d('/opt/jfrog') }}"
artifactory_dir: "{{ artifactory_jfrog_dir }}/artifactory"

# Pick the Artifactory flavour to install, can be also cpp-ce/jcr/pro
artifactory_flavour: pro

# Artifactory extra Java Options
artifactory_extra_java_opts: -server -Xms512m -Xmx4g -Xss256k -XX:+UseG1GC

# Added optional variable to download from external url
artifactory_postgresql_driver_download: true
artifactory_postgresql_driver_version: '42.7.3'

# Artifactory user/uid and groupd/gid
artifactory_user: artifactory
artifactory_uid: '1030'

artifactory_group: artifactory
artifactory_gid: '1030'

# To run Artifactory with any database other than PostgreSQL, artifactory_allow_non_postgresql set to true
artifactory_allow_non_postgresql: "{{ artifactory_allowNonPostgresql | d(false) }}"

# Default username and password, uncomment and change to manage with ansible
# artifactory_admin_username: admin
# artifactory_admin_password: password

# Allow artifactory user to create crontab rules
# Required to configure logrotate for /opt/jfrog/../console.log
artifactory_allow_crontab: true

# Provide systemyaml content below with 2-space indentation
artifactory_systemyaml: |-
  configVersion: 1
  shared:
    security:
      joinKey: "{{ join_key }}"
    extraJavaOpts: "{{ artifactory_extra_java_opts }}"
    node:
      id: {{ ansible_hostname }}
      ip: {{ ansible_host }}
      taskAffinity: {{ artifactory_taskaffinity }}
      haEnabled: {{ artifactory_ha_enabled }}
    database:
      allowNonPostgresql: {{ artifactory_allow_non_postgresql }}
      type: "{{ artifactory_db_type }}"
      driver: "{{ artifactory_db_driver }}"
      url: "{{ artifactory_db_url }}"
      username: "{{ artifactory_db_user }}"
      password: "{{ artifactory_db_password }}"
  mc:
    enabled: {{ artifactory_mc_enabled }}
  router:
    entrypoints:
      internalPort: 8046
